# Template System - Visual Workflow

## ğŸ“Š Complete System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     TEMPLATE DOCUMENT GENERATOR                      â”‚
â”‚                         (FINAL - FIXED VERSION)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   USER       â”‚
                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚                â”‚
             â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
             â”‚  Create     â”‚  â”‚  Search    â”‚  â”‚  Upload    â”‚
             â”‚  Template   â”‚  â”‚  PubMed    â”‚  â”‚  Template  â”‚
             â”‚  (.docx)    â”‚  â”‚  Articles  â”‚  â”‚  to App    â”‚
             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                â”‚                â”‚
                    â”‚                â”‚                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  TEMPLATE    â”‚
                              â”‚   MODAL      â”‚
                              â”‚   (React)    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚                â”‚
             â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
             â”‚  STEP 1:    â”‚  â”‚  STEP 2:   â”‚  â”‚  STEP 3:   â”‚
             â”‚  Upload &   â”‚â†’ â”‚  Preview   â”‚â†’ â”‚  Generate  â”‚
             â”‚  Analyze    â”‚  â”‚  Content   â”‚  â”‚  Document  â”‚
             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                â”‚                â”‚
                    â”‚                â”‚                â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚                                 â”‚
         â”‚     BACKEND API     â”‚   /api/template-final           â”‚
         â”‚   (Express.js)      â”‚   (templateFinal.js)            â”‚
         â”‚                     â”‚                                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚                â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ analyzeTemplate â”‚  â”‚  extractData â”‚  â”‚ fillTemplate â”‚
         â”‚   Structure()   â”‚  â”‚   Article()  â”‚  â”‚   Render()   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                â”‚                â”‚
                    â”‚                â”‚                â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Parse DOCX XML â”‚  â”‚  Extract:    â”‚  â”‚ Replace all  â”‚
         â”‚  Find headings  â”‚  â”‚  - Abstract  â”‚  â”‚ placeholders â”‚
         â”‚  Find tables    â”‚  â”‚  - Pharma    â”‚  â”‚ Preserve fmt â”‚
         â”‚  Find sections  â”‚  â”‚  - PK/ADME   â”‚  â”‚ Download doc â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  - Toxicologyâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚  - Abbreviateâ”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  COMPLETE    â”‚
                              â”‚  DOCUMENT    â”‚
                              â”‚  (.docx)     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow - Step by Step

### STEP 1: Upload Template

```
User                    Frontend                Backend                 Template File
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚ Select file            â”‚                       â”‚                         â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚ Click "Upload"         â”‚                       â”‚                         â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                         â”‚
  â”‚                        â”‚ POST /upload          â”‚                         â”‚
  â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚
  â”‚                        â”‚                       â”‚ Read .docx              â”‚
  â”‚                        â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚ Unzip DOCX              â”‚
  â”‚                        â”‚                       â”‚ Extract word/document.xml
  â”‚                        â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚ Parse XML with xml2js   â”‚
  â”‚                        â”‚                       â”‚ Find all headings       â”‚
  â”‚                        â”‚                       â”‚ Find all tables         â”‚
  â”‚                        â”‚                       â”‚ Find all paragraphs     â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚ Response: {           â”‚                         â”‚
  â”‚                        â”‚   analysis: {         â”‚                         â”‚
  â”‚                        â”‚     headingsCount: 15,â”‚                         â”‚
  â”‚                        â”‚     tablesCount: 2    â”‚                         â”‚
  â”‚                        â”‚   }                   â”‚                         â”‚
  â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚ "âœ… Template analyzed!"â”‚                       â”‚                         â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                         â”‚
```

---

### STEP 2: Preview Content

```
User                    Frontend                Backend                 PubMed Article
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚ Select article         â”‚                       â”‚                         â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚ Click "Preview"        â”‚                       â”‚                         â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                         â”‚
  â”‚                        â”‚ POST /preview         â”‚                         â”‚
  â”‚                        â”‚ { article }           â”‚                         â”‚
  â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚
  â”‚                        â”‚                       â”‚ extractArticleData()    â”‚
  â”‚                        â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚ Get FULL abstract text  â”‚
  â”‚                        â”‚                       â”‚ Find pharmacology       â”‚
  â”‚                        â”‚                       â”‚ Find PK/ADME data       â”‚
  â”‚                        â”‚                       â”‚ Find toxicology         â”‚
  â”‚                        â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚ extractAbbreviations()  â”‚
  â”‚                        â”‚                       â”‚ Pattern: "Term (ABBR)"  â”‚
  â”‚                        â”‚                       â”‚ Add common: PK, PD, etc â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚ Response: {           â”‚                         â”‚
  â”‚                        â”‚   extractedData: {    â”‚                         â”‚
  â”‚                        â”‚     abstract: "Avail",â”‚                         â”‚
  â”‚                        â”‚     pharmacology: ... â”‚                         â”‚
  â”‚                        â”‚   },                  â”‚                         â”‚
  â”‚                        â”‚   abbreviations: [    â”‚                         â”‚
  â”‚                        â”‚     {abbr: "PK", ...} â”‚                         â”‚
  â”‚                        â”‚   ]                   â”‚                         â”‚
  â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚ Preview panel shows    â”‚                       â”‚                         â”‚
  â”‚ content availability   â”‚                       â”‚                         â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                         â”‚
```

---

### STEP 3: Generate Document

```
User                    Frontend                Backend                 Output File
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚ Click "Generate"       â”‚                       â”‚                         â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                         â”‚
  â”‚                        â”‚ POST /generate        â”‚                         â”‚
  â”‚                        â”‚ { templatePath,       â”‚                         â”‚
  â”‚                        â”‚   article }           â”‚                         â”‚
  â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚ 1. extractArticleData() â”‚
  â”‚                        â”‚                       â”‚    - Full abstract      â”‚
  â”‚                        â”‚                       â”‚    - Pharmacology       â”‚
  â”‚                        â”‚                       â”‚    - PK/ADME            â”‚
  â”‚                        â”‚                       â”‚    - Toxicology         â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚ 2. extractAbbreviations()
  â”‚                        â”‚                       â”‚    - Find patterns      â”‚
  â”‚                        â”‚                       â”‚    - Add common terms   â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚ 3. createTemplateData() â”‚
  â”‚                        â”‚                       â”‚    {                    â”‚
  â”‚                        â”‚                       â”‚      drug_name: "...",  â”‚
  â”‚                        â”‚                       â”‚      abstract: "...",   â”‚
  â”‚                        â”‚                       â”‚      pharmacology: "...",
  â”‚                        â”‚                       â”‚      abbreviations_list:â”‚
  â”‚                        â”‚                       â”‚        "Formatted table"â”‚
  â”‚                        â”‚                       â”‚    }                    â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚ 4. docxtemplater        â”‚
  â”‚                        â”‚                       â”‚    Load template        â”‚
  â”‚                        â”‚                       â”‚    Replace {abstract}   â”‚
  â”‚                        â”‚                       â”‚    Replace {pharma...}  â”‚
  â”‚                        â”‚                       â”‚    Replace all {...}    â”‚
  â”‚                        â”‚                       â”‚    Preserve formatting  â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚ 5. Generate .docx       â”‚
  â”‚                        â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚ Response:             â”‚                         â”‚
  â”‚                        â”‚ Content-Type: blob    â”‚                         â”‚
  â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚                        â”‚ Download file         â”‚                         â”‚
  â”‚                        â”‚ Nonclinical_Overview_ â”‚                         â”‚
  â”‚                        â”‚ PMID_12345.docx       â”‚                         â”‚
  â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚ "âœ… Document generated"â”‚                       â”‚                         â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                         â”‚
  â”‚                        â”‚                       â”‚                         â”‚
  â”‚ File opens in Word     â”‚                       â”‚                         â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

---

## ğŸ§© Component Breakdown

### Frontend (React)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           TemplateDocModal.js                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  State:                                       â”‚  â”‚
â”‚  â”‚  - templateFile                               â”‚  â”‚
â”‚  â”‚  - templateInfo                               â”‚  â”‚
â”‚  â”‚  - previewData                                â”‚  â”‚
â”‚  â”‚  - isUploading                                â”‚  â”‚
â”‚  â”‚  - isGenerating                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Handlers:                                    â”‚  â”‚
â”‚  â”‚  handleFileSelect()                           â”‚  â”‚
â”‚  â”‚  handleUploadTemplate()                       â”‚  â”‚
â”‚  â”‚    â””â”€> api.uploadTemplateFinal()              â”‚  â”‚
â”‚  â”‚  handlePreview()                              â”‚  â”‚
â”‚  â”‚    â””â”€> api.previewTemplateFinal()             â”‚  â”‚
â”‚  â”‚  handleGenerate()                             â”‚  â”‚
â”‚  â”‚    â””â”€> api.generateTemplateDocFinal()         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Backend (Express + Node.js)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         templateFinal.js (639 lines)                â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Functions:                                   â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  analyzeTemplateStructure(filePath)          â”‚  â”‚
â”‚  â”‚    Input: template.docx path                 â”‚  â”‚
â”‚  â”‚    Process:                                   â”‚  â”‚
â”‚  â”‚      1. Read DOCX file                        â”‚  â”‚
â”‚  â”‚      2. Unzip to get XML                      â”‚  â”‚
â”‚  â”‚      3. Parse with xml2js                     â”‚  â”‚
â”‚  â”‚      4. Extract all headings                  â”‚  â”‚
â”‚  â”‚      5. Extract all tables                    â”‚  â”‚
â”‚  â”‚      6. Extract all paragraphs                â”‚  â”‚
â”‚  â”‚    Output: { headingsCount, tablesCount }    â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  extractArticleData(article)                 â”‚  â”‚
â”‚  â”‚    Input: PubMed article object              â”‚  â”‚
â”‚  â”‚    Process:                                   â”‚  â”‚
â”‚  â”‚      1. Get FULL abstract text                â”‚  â”‚
â”‚  â”‚      2. Handle structured abstracts           â”‚  â”‚
â”‚  â”‚      3. Find pharmacology sentences           â”‚  â”‚
â”‚  â”‚      4. Find PK/ADME sentences                â”‚  â”‚
â”‚  â”‚      5. Find toxicology sentences             â”‚  â”‚
â”‚  â”‚    Output: { abstract, pharmacology, ... }   â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  extractAbbreviations(article)               â”‚  â”‚
â”‚  â”‚    Input: article with title/abstract        â”‚  â”‚
â”‚  â”‚    Process:                                   â”‚  â”‚
â”‚  â”‚      1. Find "Full Term (ABBR)" patterns      â”‚  â”‚
â”‚  â”‚      2. Add common pharma abbreviations       â”‚  â”‚
â”‚  â”‚      3. Sort alphabetically                   â”‚  â”‚
â”‚  â”‚    Output: [{abbr, fullTerm}, ...]           â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  createAbbreviationsTable(abbreviations)     â”‚  â”‚
â”‚  â”‚    Input: Array of {abbr, fullTerm}          â”‚  â”‚
â”‚  â”‚    Process: Format as text table              â”‚  â”‚
â”‚  â”‚    Output: "Abbr    Full Term\nâ”€â”€â”€â”€â”€\n..."   â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  createTemplateData(articleData, abbrs)      â”‚  â”‚
â”‚  â”‚    Input: Extracted data + abbreviations     â”‚  â”‚
â”‚  â”‚    Process: Combine into single object        â”‚  â”‚
â”‚  â”‚    Output: {                                  â”‚  â”‚
â”‚  â”‚      drug_name: "...",                        â”‚  â”‚
â”‚  â”‚      pmid: "...",                             â”‚  â”‚
â”‚  â”‚      abstract: "...",                         â”‚  â”‚
â”‚  â”‚      pharmacology: "...",                     â”‚  â”‚
â”‚  â”‚      abbreviations_list: "..."                â”‚  â”‚
â”‚  â”‚    }                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Routes:                                      â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  POST /upload                                 â”‚  â”‚
â”‚  â”‚    1. Receive template file                   â”‚  â”‚
â”‚  â”‚    2. Save to uploads/                        â”‚  â”‚
â”‚  â”‚    3. Analyze structure                       â”‚  â”‚
â”‚  â”‚    4. Return { templatePath, analysis }       â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  POST /preview                                â”‚  â”‚
â”‚  â”‚    1. Receive templatePath + article          â”‚  â”‚
â”‚  â”‚    2. Extract data from article               â”‚  â”‚
â”‚  â”‚    3. Extract abbreviations                   â”‚  â”‚
â”‚  â”‚    4. Return { extractedData, abbreviations } â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  POST /generate                               â”‚  â”‚
â”‚  â”‚    1. Receive templatePath + article          â”‚  â”‚
â”‚  â”‚    2. Extract all data                        â”‚  â”‚
â”‚  â”‚    3. Create template data object             â”‚  â”‚
â”‚  â”‚    4. Load template with docxtemplater        â”‚  â”‚
â”‚  â”‚    5. Replace all placeholders                â”‚  â”‚
â”‚  â”‚    6. Generate new .docx                      â”‚  â”‚
â”‚  â”‚    7. Send as download                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Libraries Used

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  docxtemplater                                       â”‚
â”‚  â”œâ”€ Fills placeholders in DOCX templates             â”‚
â”‚  â”œâ”€ Preserves formatting and structure               â”‚
â”‚  â””â”€ Syntax: {placeholder_name}                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  pizzip (PizZip)                                     â”‚
â”‚  â”œâ”€ Unzips DOCX files (DOCX is a zip archive)        â”‚
â”‚  â”œâ”€ Extracts word/document.xml                       â”‚
â”‚  â””â”€ Used with docxtemplater                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  xml2js                                              â”‚
â”‚  â”œâ”€ Parses XML to JavaScript objects                 â”‚
â”‚  â”œâ”€ Used to analyze DOCX structure                   â”‚
â”‚  â””â”€ Finds headings, tables, paragraphs               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  multer                                              â”‚
â”‚  â”œâ”€ Handles file uploads in Express                  â”‚
â”‚  â”œâ”€ Saves uploaded templates to disk                 â”‚
â”‚  â””â”€ Provides file metadata                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Template Processing

### How {placeholders} are Replaced:

```
TEMPLATE FILE:                     DATA OBJECT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MODULE 2.4              â”‚        â”‚ {                        â”‚
â”‚ Drug: {drug_name}       â”‚        â”‚   drug_name: "Aspirin",  â”‚
â”‚ PMID: {pmid}            â”‚        â”‚   pmid: "12345678",      â”‚
â”‚                         â”‚        â”‚   abstract: "Aspirin is  â”‚
â”‚ ABSTRACT:               â”‚   +    â”‚     a widely used drug..â”‚
â”‚ {abstract}              â”‚        â”‚     [300 words]",        â”‚
â”‚                         â”‚        â”‚   abbreviations_list:    â”‚
â”‚ ABBREVIATIONS:          â”‚        â”‚     "Abbr | Full Term\n  â”‚
â”‚ {abbreviations_list}    â”‚        â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n â”‚
â”‚                         â”‚        â”‚      PK | Pharma..."     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ }                        â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ docxtemplater   â”‚
              â”‚ .render(data)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
FILLED DOCUMENT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MODULE 2.4                              â”‚
â”‚ Drug: Aspirin                           â”‚
â”‚ PMID: 12345678                          â”‚
â”‚                                         â”‚
â”‚ ABSTRACT:                               â”‚
â”‚ Aspirin is a widely used drug for      â”‚
â”‚ pain relief and inflammation. This      â”‚
â”‚ study investigated the pharmacokinetics â”‚
â”‚ in healthy volunteers... [300 words]   â”‚
â”‚                                         â”‚
â”‚ ABBREVIATIONS:                          â”‚
â”‚ Abbr           Full Term                â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ PK             Pharmacokinetics         â”‚
â”‚ PD             Pharmacodynamics         â”‚
â”‚ ADME           Absorption, Distribution â”‚
â”‚                Metabolism, Excretion    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Abbreviations Extraction Flow

```
INPUT: Article abstract
â”œâ”€ "This study investigated the pharmacokinetics (PK) and
â”‚   pharmacodynamics (PD) of aspirin. The area under the
â”‚   curve (AUC) and maximum concentration (Cmax) were
â”‚   measured using high-performance liquid chromatography
â”‚   (HPLC)."

STEP 1: Find patterns "Full Term (ABBR)"
â”œâ”€ Pattern match: /([A-Z][a-z]+.*)\s*\(([A-Z]{2,6})\)/g
â”œâ”€ Found: "pharmacokinetics (PK)"
â”œâ”€ Found: "pharmacodynamics (PD)"
â”œâ”€ Found: "area under the curve (AUC)"
â”œâ”€ Found: "maximum concentration (Cmax)"
â””â”€ Found: "high-performance liquid chromatography (HPLC)"

STEP 2: Add common pharmaceutical abbreviations
â”œâ”€ Check if "ADME" appears in text â†’ Not found
â”œâ”€ Check if "Tmax" appears in text â†’ Not found
â”œâ”€ Check if "IC50" appears in text â†’ Not found
â””â”€ Only add terms that appear in the text

STEP 3: Sort and format
â”œâ”€ Sort alphabetically: AUC, Cmax, HPLC, PD, PK
â””â”€ Format as table:

OUTPUT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Abbreviation    Full Term                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ AUC            Area Under the Curve               â”‚
â”‚ Cmax           Maximum Concentration              â”‚
â”‚ HPLC           High-Performance Liquid Chroma...  â”‚
â”‚ PD             Pharmacodynamics                   â”‚
â”‚ PK             Pharmacokinetics                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Quality Checks

### System Validates:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BEFORE PROCESSING                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ“ Template file is .docx format            â”‚
â”‚  âœ“ Template contains placeholders           â”‚
â”‚  âœ“ Article data is available                â”‚
â”‚  âœ“ Abstract exists                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DURING PROCESSING                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ“ Extract FULL abstract (not excerpt)      â”‚
â”‚  âœ“ Find all abbreviation patterns           â”‚
â”‚  âœ“ Generate formatted table                 â”‚
â”‚  âœ“ Map content to correct placeholders      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER PROCESSING                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ“ All placeholders replaced                â”‚
â”‚  âœ“ No "{...}" text remaining                â”‚
â”‚  âœ“ Formatting preserved                     â”‚
â”‚  âœ“ File downloadable                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

This visual workflow shows exactly how your template system works from start to finish!
